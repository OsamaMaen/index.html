<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Farah My Happiness</title>
    <style>
        body { margin: 0; padding: 0; font-family: 'Segoe UI', sans-serif; height: 100vh; width: 100vw; display: flex; justify-content: center; align-items: center; overflow: hidden; position: relative; background-image: url('covers/hearts.jpg'); background-size: 100% 100%; background-position: center; background-repeat: no-repeat; cursor: crosshair; }
        body::before { content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(to bottom, rgba(247, 177, 177, 0.4) 0%, rgba(255, 255, 255, 0.6) 100%); z-index: 1; }
        
        /* CURSOR TRAIL STYLE */
        .cursor-heart { position: fixed; color: #ffb7c5; pointer-events: none; z-index: 999999; animation: floatUp 1s ease-out forwards; font-size: 20px; }
        @keyframes floatUp { 0% { transform: translateY(0) scale(1); opacity: 1; } 100% { transform: translateY(-50px) scale(1.5); opacity: 0; } }

        /* FLOATING LOVE TEXTS */
        .floating-text { position: fixed; pointer-events: none; z-index: 2; font-weight: 400; color: #ffb7c5; text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.5); animation: floatAndFade 4s ease-out forwards; white-space: nowrap; font-family: 'Georgia', serif; letter-spacing: 0.5px; }
        @keyframes floatAndFade { 0% { transform: translateY(0); opacity: 0; } 15% { opacity: 0.85; } 100% { transform: translateY(-80px); opacity: 0; } }

        /* PINK CHILL PETALS */
        .petal { position: fixed; background-color: #ffb7c5; border-radius: 150% 0 150% 0; z-index: 5; pointer-events: none; opacity: 0; filter: drop-shadow(0 0 2px rgba(0,0,0,0.1)); }
        @keyframes fall {
            0% { transform: translateY(-25vh) translateX(0) rotate(0deg); opacity: 0; }
            15% { opacity: 0.8; }
            50% { transform: translateY(50vh) translateX(60px) rotate(180deg); }
            100% { transform: translateY(110vh) translateX(20px) rotate(360deg); opacity: 0; }
        }

        .container { position: relative; z-index: 10; text-align: center; background: white; padding: 40px; border-radius: 30px; box-shadow: 0 15px 45px rgba(0,0,0,0.15); width: 90%; max-width: 550px; max-height: 85vh; border: 1px solid rgba(0,0,0,0.03); transition: all 0.3s ease; overflow-y: auto; }
        .container.book-mode { background: none; box-shadow: none; border: none; width: 100vw; max-width: none; overflow: visible; display: flex; flex-direction: column; align-items: center; justify-content: center; }

        #main-text { font-size: 1.6rem; margin-bottom: 25px; color: #a42323; font-style: italic; font-weight: 700; line-height: 1.4; white-space: pre-wrap; }
        .meme-img { width: 100%; max-height: 250px; object-fit: contain; border-radius: 15px; margin-bottom: 20px; display: none; }
        .button-group { display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; }
        .quiz-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; display: none; }
        .btn { display: inline-block; padding: 12px 25px; border-radius: 50px; font-weight: bold; font-size: 0.9rem; text-transform: uppercase; transition: all 0.2s ease; cursor: pointer; border: none; margin-bottom: 5px; position: relative; }
        .btn-yes { background-color: #a42323; color: white; box-shadow: 0 4px 15px rgba(164, 35, 35, 0.3); }
        .btn-yes:hover { transform: scale(1.05); }
        .btn-no { background-color: #f1f1f1; color: #777; }
        .btn-jk, .btn-retry { background-color: #ff9f43; color: white; }
        .btn-choice { background-color: white; border: 2px solid #a42323; color: #a42323; width: 100%; }
        .btn-choice:hover { background-color: #a42323; color: white; }
        textarea { width: 100%; height: 100px; padding: 15px; border-radius: 15px; border: 2px solid #a42323; font-family: inherit; margin-bottom: 20px; resize: none; box-sizing: border-box; font-size: 1rem; }

        .player-wrapper { position: fixed; bottom: 20px; right: 20px; z-index: 10000; display: none; width: 320px; }
        .music-player { background: white; padding: 15px; border-radius: 25px; box-shadow: 0 10px 30px rgba(219, 58, 120, 0.3); display: flex; flex-direction: column; gap: 12px; border: 2px solid #db3a78; }
        .player-top { display: flex; align-items: center; gap: 15px; }
        .album-art { width: 60px; height: 60px; border-radius: 15px; object-fit: cover; flex-shrink: 0; background: #fce4ec; border: 1px solid #eee; }
        .player-info { flex-grow: 1; text-align: left; overflow: hidden; }
        .song-title { font-weight: bold; color: #db3a78; font-size: 0.85rem; display: block; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .singer-name { font-size: 0.75rem; color: #ff80ab; display: block; margin-bottom: 5px; }
        .controls { display: flex; align-items: center; gap: 12px; }
        .music-btn { background: none; border: none; cursor: pointer; color: #db3a78; font-size: 1.1rem; padding: 0; }
        .volume-container { display: flex; align-items: center; padding-top: 5px; }
        #volume-control { -webkit-appearance: none; width: 100%; height: 2px; background: #ffb6c1; border-radius: 5px; outline: none; cursor: pointer; }
        #volume-control::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 14px; height: 14px; background: #db3a78; border-radius: 50%; cursor: pointer; border: 2px solid white; }

        .popping-heart { position: fixed; z-index: 99999; pointer-events: none; font-size: 28px; animation: popAndFade 1.2s ease-out forwards; }
        @keyframes popAndFade { 0% { transform: translate(-50%, -50%) scale(0.2); opacity: 1; } 100% { transform: translate(var(--tw), var(--th)) scale(4); opacity: 0; } }
        .arabic-text { direction: rtl; display: block; font-size: 1.3rem; margin: 15px 0; color: #a42323; font-weight: bold; }

        /* BOOK STYLING */
        .book-viewport { perspective: 2500px; width: 100%; height: 750px; display: flex; justify-content: center; align-items: center; user-select: none; }
        .book { position: relative; width: 450px; height: 600px; transform-style: preserve-3d; transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1); transform: translateX(0); }
        .book.is-open { transform: translateX(225px); }
        .hard-cover { position: absolute; width: 460px; height: 610px; background: #8a1d1d; top: -5px; border-radius: 5px; z-index: -1; transition: transform 1s; box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .hard-cover.left { left: 0; transform-origin: left; transform: rotateY(-180deg); display: none; border-right: 15px solid #631515; }
        .hard-cover.right { left: 0; border-left: 15px solid #631515; }
        
        .page { position: absolute; width: 450px; height: 600px; top: 0; left: 0; transform-origin: left; transform-style: preserve-3d; transition: transform 1s cubic-bezier(0.4, 0, 0.2, 1); }
        .page-front, .page-back { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; display: flex; flex-direction: column; justify-content: center; align-items: center; box-sizing: border-box; background: #fffcf0; border: 1px solid #ddd; overflow: hidden; padding: 20px; }
        .page-front { border-radius: 0 5px 5px 0; background: linear-gradient(to right, #e8e4d5 0%, #fffcf0 5%, #fffcf0 100%); z-index: 2; box-shadow: inset 3px 0 10px rgba(0,0,0,0.05); }
        .page-back { transform: rotateY(180deg); border-radius: 5px 0 0 5px; background: linear-gradient(to left, #e8e4d5 0%, #fffcf0 5%, #fffcf0 100%); z-index: 1; box-shadow: inset -3px 0 10px rgba(0,0,0,0.05); }

        .photo-frame { background: white; padding: 10px 10px 30px 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.2); transform: rotate(var(--r)); width: 85%; }
        .photo-frame img { width: 100%; height: 400px; object-fit: cover; border: 1px solid #eee; }
        .photo-caption { margin-top: 15px; font-family: 'Brush Script MT', cursive; font-size: 1.5rem; color: #555; text-align: center; }

        .final-letter { padding: 30px; color: #a42323; line-height: 1.6; text-align: center; font-style: italic; animation: softGlow 3s ease-in-out infinite; }
        @keyframes softGlow { 0%, 100% { background-color: #fffcf0; } 50% { background-color: #fff5f5; box-shadow: inset 0 0 50px rgba(255, 182, 193, 0.2); } }
        .final-letter p { font-size: 1.15rem; margin-bottom: 12px; }
        .continue-text { position: absolute; bottom: 20px; right: 20px; font-size: 0.9rem; color: #777; font-family: 'Georgia', serif; font-weight: bold; }

        .red-cover { background: #a42323 !important; color: #f7b1b1 !important; border: 1px solid #7a1a1a !important; padding: 0; }
        .cover-title { font-family: 'Georgia', serif; font-size: 2.2rem; text-align: center; border: 4px solid #f7b1b1; padding: 20px; text-transform: lowercase; }
        .swipe-hint { color: #a42323; font-weight: bold; margin-top: 30px; font-size: 1.4rem; z-index: 100; text-shadow: 1px 1px white; }

        .pulse-text { animation: heartbeat 2s infinite; display: block; }
        @keyframes heartbeat { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); } }
    </style>
</head>
<body>

    <div class="player-wrapper" id="player-ui">
        <div class="music-player">
            <div class="player-top">
                <img src="covers/cover1.png" class="album-art" id="album-img">
                <div class="player-info">
                    <span class="song-title" id="song-name">Beautiful Stranger</span>
                    <span class="singer-name">For my Princess</span>
                    <div class="controls">
                        <button class="music-btn" onclick="prevSong()">‚èÆ</button>
                        <button class="music-btn" id="play-pause" onclick="togglePlay()">‚è∏</button>
                        <button class="music-btn" onclick="nextSong()">‚è≠</button>
                    </div>
                </div>
            </div>
            <div class="volume-container">
                <input type="range" id="volume-control" min="0" max="1" step="0.01" value="0.8">
            </div>
            <audio id="bg-music" src="songs/song1.mp3"></audio>
        </div>
    </div>

    <div class="container" id="note">
        <img src="meme/1.jpg" id="meme" class="meme-img">
        <h1 id="main-text">Will you be my forever valentine?</h1>
        <div class="button-group" id="btn-container"></div>
        <div class="quiz-grid" id="quiz-container"></div>
    </div>

    <script>
        let currentStage = "proposal";
        let currentSongIndex = 0;
        let currentPage = 0;
        let totalPages = 18; // Increased for the final spread
        const music = document.getElementById('bg-music');
        const playBtn = document.getElementById('play-pause');
        const volSlider = document.getElementById('volume-control');
        const noteBox = document.getElementById('note');

        function transitionQuestion(callback) {
            noteBox.classList.add('fade-out-down');
            setTimeout(() => {
                callback(); 
                noteBox.classList.remove('fade-out-down');
                noteBox.classList.add('fade-in-up');
                setTimeout(() => {
                    noteBox.classList.remove('fade-in-up');
                }, 500);
            }, 400);
        }

        document.addEventListener('mousemove', (e) => {
            if (Math.random() > 0.9) { 
                const heart = document.createElement('div');
                heart.className = 'cursor-heart';
                heart.innerHTML = 'üå∏';
                heart.style.left = e.clientX + 'px';
                heart.style.top = e.clientY + 'px';
                document.body.appendChild(heart);
                setTimeout(() => heart.remove(), 1000);
            }
        });

        function startLoveTexts() {
            const phrases = ["i love you", "my princess", "my future wife", "mwah üíã"];
            setInterval(() => {
                phrases.forEach(phrase => {
                    const el = document.createElement('div');
                    el.className = 'floating-text';
                    el.innerHTML = phrase;
                    let x, y, isOverlapping;
                    let attempts = 0;
                    do {
                        x = Math.random() * 90;
                        y = Math.random() * 90;
                        const pxX = (x / 100) * window.innerWidth;
                        const pxY = (y / 100) * window.innerHeight;
                        const rect = noteBox.getBoundingClientRect();
                        isOverlapping = (pxX > rect.left - 40 && pxX < rect.right + 40 && pxY > rect.top - 40 && pxY < rect.bottom + 40);
                        attempts++;
                    } while (isOverlapping && attempts < 8);
                    el.style.left = x + 'vw';
                    el.style.top = y + 'vh';
                    el.style.fontSize = (Math.random() * 6 + 14) + 'px';
                    document.body.appendChild(el);
                    setTimeout(() => el.remove(), 4000);
                });
            }, 500);
        }

        function createPetals() {
            setInterval(() => {
                const petal = document.createElement('div');
                petal.className = 'petal';
                const size = Math.random() * 15 + 10 + 'px';
                petal.style.width = size;
                petal.style.height = size;
                petal.style.left = Math.random() * 100 + 'vw';
                const duration = Math.random() * 6 + 12 + 's';
                petal.style.animation = `fall ${duration} forwards linear`;
                document.body.appendChild(petal);
                setTimeout(() => { petal.remove(); }, parseFloat(duration) * 1000);
            }, 150); 
        }

        volSlider.addEventListener('input', (e) => { music.volume = e.target.value; });
        function togglePlay() { if (music.paused) { music.play(); playBtn.innerText = "‚è∏"; } else { music.pause(); playBtn.innerText = "‚ñ∂"; } }
        function updateSong() {
            music.src = `songs/song${currentSongIndex + 1}.mp3`;
            document.getElementById('album-img').src = `covers/cover${currentSongIndex + 1}.png`; 
            const titles = ["Beautiful Stranger", "Until i found you", "Perfect", "Her", "Valentines", "Line without a hook"];
            document.getElementById('song-name').innerText = titles[currentSongIndex] || "Favorite Song";
            music.play();
            playBtn.innerText = "‚è∏";
        }
        function nextSong() { currentSongIndex = (currentSongIndex + 1) % 6; updateSong(); }
        function prevSong() { currentSongIndex = (currentSongIndex - 1 + 6) % 6; updateSong(); }

        function init() {
            createPetals();
            startLoveTexts();
            document.getElementById('btn-container').innerHTML = `
                <button class="btn btn-yes" onclick="handleYes(event)">Yes</button>
                <button class="btn btn-no" onclick="handleNo()">No</button>
            `;
        }
        init();

        function triggerExplosion(event, amount = 40) {
            let centerX, centerY;
            if (event && event.target) {
                const rect = event.target.getBoundingClientRect();
                centerX = rect.left + rect.width / 2;
                centerY = rect.top + rect.height / 2;
            } else {
                centerX = window.innerWidth / 2;
                centerY = window.innerHeight / 2;
            }
            for (let i = 0; i < amount; i++) {
                setTimeout(() => {
                    const heart = document.createElement('div');
                    heart.classList.add('popping-heart');
                    heart.innerHTML = 'üíó';
                    const dX = (Math.random() - 0.5) * (amount > 100 ? window.innerWidth : 600);
                    const dY = (Math.random() - 0.5) * (amount > 100 ? window.innerHeight : 600);
                    heart.style.setProperty('--tw', `${dX}px`);
                    heart.style.setProperty('--th', `${dY}px`);
                    heart.style.left = centerX + 'px';
                    heart.style.top = centerY + 'px';
                    document.body.appendChild(heart);
                    setTimeout(() => heart.remove(), 1200);
                }, i * 10);
            }
        }

        function handleNo() {
            const memeImg = document.getElementById('meme');
            const mainText = document.getElementById('main-text');
            const btnGroup = document.getElementById('btn-container');
            memeImg.style.display = 'block';
            if (currentStage === "proposal") {
                memeImg.src = "meme/1.jpg";
                mainText.innerText = "Nigga, you have no choice";
                btnGroup.innerHTML = `<button class="btn btn-yes" onclick="handleYes(event)">Yes</button>`;
            } else if (currentStage === "game_invite") {
                memeImg.src = "meme/2.jpg";
                mainText.innerText = "Buddy... üíî ü•Ä";
                btnGroup.innerHTML = `<button class="btn btn-jk" onclick="handleJk(event)">jk jk lets play</button>`;
            }
        }

        function handleYes(event) { 
            triggerExplosion(event); 
            setTimeout(() => { 
                if (currentStage === "proposal") transitionQuestion(setupGameInvite); 
                else if (currentStage === "game_invite") transitionQuestion(startQuestion1); 
            }, 600); 
        }
        function handleJk(event) { triggerExplosion(event); setTimeout(() => { transitionQuestion(startQuestion1); }, 600); }

        function setupGameInvite() {
            currentStage = "game_invite";
            document.getElementById('meme').style.display = 'none';
            document.getElementById('main-text').innerText = "Now let's play a small questions game. If you answer all correctly, you might get a gift‚Äîwho knows? \n\n Are you ready, my happiness?";
            document.getElementById('btn-container').innerHTML = `<button class="btn btn-yes" onclick="handleYes(event)">Yes</button><button class="btn btn-no" onclick="handleNo()">No</button>`;
        }

        function startQuestion1() {
            currentStage = "question_1";
            document.getElementById('meme').style.display = 'none';
            document.getElementById('btn-container').innerHTML = "";
            const quiz = document.getElementById('quiz-container');
            quiz.style.display = 'grid';
            document.getElementById('main-text').innerText = "First,\n let's start from the beginning of everything... \n\n When did we meet each other?";
            quiz.innerHTML = `
                <button class="btn btn-choice" onclick="wrongAnswer('meme/3.jpg', 'alr buddy üíîüíî')">20th of Nov 2025</button>
                <button class="btn btn-choice" onclick="wrongAnswer('meme/4.jpg', 'baby you sure you love me?? ü•Äü•Ä')">23rd of Nov 2025</button>
                <button class="btn btn-choice" onclick="wrongAnswer('meme/5.jpg', 'It\\'s the 14th of Feb 2026... did we meet in the future or something, dumbass?')">22nd of Nov 2026</button>
                <button class="btn btn-choice" onclick="handleCorrect1(event)">22nd of Nov 2025</button>`;
        }

        function handleCorrect1(event) { triggerExplosion(event); setTimeout(() => { transitionQuestion(startQuestion2); }, 600); }

        function startQuestion2() {
            currentStage = "question_2";
            document.getElementById('meme').style.display = 'none';
            document.getElementById('btn-container').innerHTML = "";
            const quiz = document.getElementById('quiz-container');
            quiz.style.display = 'grid';
            document.getElementById('main-text').innerText = "Alright, that's correct! Now let's go to the 2nd question:\n\nWhat's my birthday? üôÇ";
            quiz.innerHTML = `
                <button class="btn btn-choice" onclick="handleCorrect2(event)">20th of April 2009</button>
                <button class="btn btn-choice" onclick="wrongAnswer('meme/7.jpg', 'buddy you hate me fr..i will give you another chance try it', 'Chance')">29th of April 2009</button>
                <button class="btn btn-choice" onclick="wrongAnswer('meme/8.jpg', 'wrong person buddy ü•Ä', 'mb mb')">11th of Sep 2001</button>
                <button class="btn btn-choice" onclick="wrongAnswer('meme/9.jpg', 'baby im not you and you are not me\\nits only im yours and you are mine', 'back')">14th of Mar 2011</button>`;
        }

        function handleCorrect2(event) { triggerExplosion(event); setTimeout(() => { transitionQuestion(startQuestion3); }, 600); }

        function startQuestion3() {
            currentStage = "question_3";
            const memeImg = document.getElementById('meme');
            memeImg.src = "meme/6.jpg"; 
            memeImg.style.display = 'block';
            document.getElementById('btn-container').innerHTML = "";
            const quiz = document.getElementById('quiz-container');
            quiz.style.display = 'grid';
            document.getElementById('main-text').innerText = "Hell yeah, you remembered itttttt!\nLove you so, so, so much, my adorable princess.\n\nAlright, let's go to the 3rd question:\nWhat do I love most in this life?";
            quiz.innerHTML = `
                <button class="btn btn-choice" onclick="wrongAnswer('meme/10.jpg', 'alr i mean its true but didnt you see something else i like more??', 'try again')"> Bikes</button>
                <button class="btn btn-choice" onclick="wrongAnswer('meme/11.jpg', 'hell no nigga try again', 'try again')"> Studying</button>
                <button class="btn btn-choice" onclick="wrongAnswer('meme/11.jpg', 'hell no try something else', 'try again', true)"> You</button>
                <button class="btn btn-choice" onclick="wrongAnswer('meme/12.jpg', 'buddy i dont even have money to buy it üíî', 'try again')"> Monster energy drink</button>`;
        }

        function wrongAnswer(imgSource, message, btnText = "try again üíî", isJoke = false) {
            transitionQuestion(() => {
                const memeImg = document.getElementById('meme');
                memeImg.src = imgSource; memeImg.style.display = 'block';
                document.getElementById('main-text').innerText = message;
                document.getElementById('quiz-container').style.display = 'none';
                const action = isJoke ? "startQuestion4(event)" : "retryQuestion()";
                document.getElementById('btn-container').innerHTML = `<button class="btn btn-retry" onclick="${action}">${btnText}</button>`;
            });
        }

        function startQuestion4(event) {
            triggerExplosion(event);
            transitionQuestion(() => {
                currentStage = "question_4";
                document.getElementById('meme').style.display = 'none';
                document.getElementById('main-text').innerText = "NIGGA OFC ITS YOU FYM CHOOSE ANOTHER THING\n\nAnyway, let's go to the last request...";
                document.getElementById('btn-container').innerHTML = `<button class="btn btn-yes" onclick="setupFinalRequest(event)">Go to final request</button>`;
            });
        }

        function retryQuestion() { 
            transitionQuestion(() => {
                document.getElementById('meme').style.display = 'none'; 
                if (currentStage === "question_1") startQuestion1(); 
                else if (currentStage === "question_2") startQuestion2(); 
                else if (currentStage === "question_3") startQuestion3(); 
            });
        }

        function setupFinalRequest(event) {
            triggerExplosion(event);
            transitionQuestion(() => {
                document.getElementById('main-text').innerText = "alr its not a question to answer with choices ..\nits like a request from you to write something beautiful to me to make me happy?\nsooo write anything you think that gonna make me happy here \n like a letter?";
                document.getElementById('btn-container').innerHTML = `
                    <form id="valentineForm" style="width: 100%;">
                        <textarea name="message" id="userMessage" placeholder="Type here..." required></textarea>
                        <button type="submit" class="btn btn-yes">Send to my heart</button>
                    </form>`;

                const form = document.getElementById('valentineForm');
                form.onsubmit = (e) => {
                    e.preventDefault();
                    triggerExplosion(e);
                    
                    const userMsg = document.getElementById('userMessage').value;

                    fetch("https://formspree.io/f/mdalndll", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({ message: userMsg })
                    }).finally(() => {
                        showLoveLetter();
                    });
                };
            });
        }

        function showLoveLetter() {
            transitionQuestion(() => {
                document.getElementById('player-ui').style.display = 'block';
                updateSong(); 
                const container = document.getElementById('note');
                container.style.maxWidth = "650px";
                container.innerHTML = `
                    <div style="text-align: left; line-height: 1.6; color: #a42323;">
                        <h2 style="text-align: center;">‚ù§Ô∏è To My Princess ‚ù§Ô∏è</h2>
                        <p>thanks for that baby i will see it as soon as i can and im sure it will make me soooo happy cuz everything you do makes me happy</p>
                        <p>alrr, i love you so much baby.. really thank you for everything you have ever done to me</p>
                        <p>the times you were with me when i was sad<br>the times you told me to keep going and study so i can get good grades<br>the times u didnt care if its ok to study and not talking alot... well i know that u were kinda sad when you do it butt you did it and that helped me alot</p>
                        <p>really thank you my amazing baby<br>you even make me feel like a human and handsome when u say good things about my look and my hair and my face and my feelings like im actully a human?</p>
                        <p>i really love you</p>
                        <span class="arabic-text">Ÿäÿß ÿ≠Ÿäÿßÿ™Ÿä ŸàŸÇŸÑÿ®Ÿä ŸàŸÖŸÑÿßŸÉŸä ŸàÿßŸÖŸäÿ±ÿ™Ÿä Ÿàÿ±Ÿàÿ≠Ÿä ŸàŸÖÿ≠Ÿàÿ± ŸÉŸàŸÜ ŸàŸÜŸàÿ± ÿπŸäŸÜŸä Ÿàÿ¨ŸÖŸäŸÑÿ™Ÿä ŸàŸÅÿ±Ÿàÿ≠ÿ™Ÿä ŸàŸÅÿ±ŸÅŸàÿ±ÿ™Ÿä ŸàŸÇÿ≤ŸÖÿ™Ÿä Ÿàÿπÿ¥ŸÇŸä</span>
                        <p>i love you and im addicted to you soo muchh<br>id rather die than leaving you and will stay with you until my last breath ya 3eni</p>
                        <p>and sorry that the best thing i could do to you in this day cuz yk idk how to buy you things online without visa card so yea sorry</p>
                        <p style="font-weight: bold;">love you so much,<br>Osama</p>
                        <div style="text-align: center; margin-top: 30px; padding-bottom: 20px;"><button class="btn btn-yes" onclick="transitionToBook()">Open Our Album</button></div>
                    </div>`;
                container.scrollTop = 0;
            });
        }

        function transitionToBook() {
            triggerExplosion(null, 150); 
            const container = document.getElementById('note');
            container.classList.add('book-mode');
            let photoPages = '';
            let pIdx = 1;

            photoPages += `
                <div class="page" id="p1" style="z-index: 50;">
                    <div class="page-front red-cover"><div class="cover-title">the album of memories</div></div>
                    <div class="page-back">
                        <div class="photo-frame" style="--r: 2deg;">
                            <img src="girl pics/memory${pIdx}.jpg">
                            <div class="photo-caption">Moment #${pIdx++}</div>
                        </div>
                    </div>
                </div>`;

            for (let i = 2; i <= 15; i++) {
                let imgFront = pIdx++;
                let imgBack = pIdx++;
                photoPages += `
                <div class="page" id="p${i}" style="z-index: ${50 - i};">
                    <div class="page-front">
                        ${imgFront <= 30 ? `<div class="photo-frame" style="--r: -1deg;"><img src="girl pics/memory${imgFront}.jpg"><div class="photo-caption">Moment #${imgFront}</div></div>` : ''}
                    </div>
                    <div class="page-back">
                        ${imgBack <= 30 ? `<div class="photo-frame" style="--r: 1deg;"><img src="girl pics/memory${imgBack}.jpg"><div class="photo-caption">Moment #${imgBack}</div></div>` : ''}
                    </div>
                </div>`;
            }

            photoPages += `
                <div class="page" id="p16" style="z-index: 34;">
                    <div class="page-front">
                        <div class="photo-frame" style="--r: -2deg;">
                            <img src="girl pics/memory30.jpg">
                            <div class="photo-caption">Moment #30</div>
                        </div>
                    </div>
                    <div class="page-back">
                        <div class="final-letter">
                            <p>here is the end of our journey in this memories book but it will be bigger and bigger by the time so dont worry</p>
                            <p>love you so much baby and hope we can continue this relationship until the end of our life</p>
                            <p>i love you my best adorable amazing angelic princess in this world</p>
                            <p class="pulse-text" style="font-weight: bold; font-size: 1.4rem; color: #a42323;">HAPPY VALENTINES DAY (üåü‚ù§Ô∏èüíìüåπüå∏)</p>
                            <p style="font-size: 1.5rem;">MMMWWWWWAAAAAAAHHHHHHHHH üíã</p>
                            <div class="continue-text">Flip for one last thing... ‚û°Ô∏è</div>
                        </div>
                    </div>
                </div>`;

            // PAGE 17 - Flips to become the LEFT side of the open spread
            photoPages += `
                <div class="page" id="p17" style="z-index: 33;">
                    <div class="page-front">
                        <div class="final-letter" style="background:#fffcf0; height:100%; display:flex; align-items:center; justify-content:center;">
                            <p style="font-size: 1.5rem;">A message for you...</p>
                        </div>
                    </div>
                    <div class="page-back">
                        <div class="final-letter" style="text-align: left; font-size: 0.95rem; padding: 25px; font-style: normal; height:100%;">
                            <p style="font-weight: bold; color: #7a1a1a; margin-bottom: 10px; text-decoration: underline;">Edit: Feb 11th</p>
                            <p>Alr baby look.. i know life sucks, its so bad and fucked up and sometimes you feel like you just want to stop doing everything and just sleep without doing anything because you are tired.</p>
                            <p>Yea i know it, and i know it so much too. I had worse things that i dont want to tell you cuz its so bad, but look... whatever is happening with anyone... it will get better soon.</p>
                            <p>Not sooo soon, but it will, trust me. Just keep going and dont give up on anything. I will support you with every move you are doing if it means its good for you and your future okay?</p>
                        </div>
                    </div>
                </div>`;

            // PAGE 18 - Sits behind Page 17. Its FRONT becomes the RIGHT side of the open spread.
            photoPages += `
                <div class="page" id="p18" style="z-index: 32;">
                    <div class="page-front">
                        <div class="final-letter" style="text-align: left; font-size: 0.95rem; padding: 25px; font-style: normal; height:100%;">
                            <p>Just know that you need to keep going and keep trying and dont give up. I dont say to keep going without stopping; you can take some rests sometimes when you are tired, but choose them at the right time so no one can annoy you.</p>
                            <p>About your parents talking bad about you, its not your fault that they are shit... just ignore it and focus on yourself and your future, because that's what really matters.</p>
                            <p>I'm always here for you, no matter what. You're never alone in this. ‚ù§Ô∏è</p>
                            <p style="text-align: center; margin-top: 30px; font-weight: bold; font-size: 1.4rem; color: #a42323;">I Love You Forever</p>
                        </div>
                    </div>
                    <div class="page-back">
                         <div style="background:#8a1d1d; height:100%; width:100%;"></div>
                    </div>
                </div>`;

            container.innerHTML = `
                <div class="book-viewport">
                    <div class="book" id="book">
                        <div class="hard-cover left" id="cover-L"></div>
                        <div class="hard-cover right" id="cover-R"></div>
                        ${photoPages}
                    </div>
                </div>
                <div class="swipe-hint" id="hint">Swipe Left to Open ‚û°Ô∏è</div>`;
            setupBookPhysics();
        }

        function setupBookPhysics() {
            const viewport = document.querySelector('.book-viewport');
            let startX = 0;
            viewport.onmousedown = e => { startX = e.clientX; };
            viewport.ontouchstart = e => { startX = e.touches[0].clientX; };
            viewport.onmouseup = e => { let diff = startX - e.clientX; if (Math.abs(diff) > 50) diff > 0 ? flipNext() : flipPrev(); };
            viewport.ontouchend = e => { let diff = startX - e.changedTouches[0].clientX; if (Math.abs(diff) > 50) diff > 0 ? flipNext() : flipPrev(); };
        }

        function flipNext() {
            if (currentPage < totalPages) {
                currentPage++;
                const p = document.getElementById('p' + currentPage);
                const book = document.getElementById('book');
                const coverL = document.getElementById('cover-L');
                book.style.transform = `translateX(${currentPage > 0 ? '225px' : '0'}) scale(1.01)`;
                setTimeout(() => { book.style.transform = `translateX(${currentPage > 0 ? '225px' : '0'}) scale(1)`; }, 100);
                if(currentPage === 1) { book.classList.add('is-open'); coverL.style.display = 'block'; }
                p.style.transform = "rotateY(-180deg)";
                p.style.zIndex = 50 + currentPage;
                updateHint();
            }
        }

        function flipPrev() {
            if (currentPage > 0) {
                const p = document.getElementById('p' + currentPage);
                const book = document.getElementById('book');
                const coverL = document.getElementById('cover-L');
                p.style.transform = "rotateY(0deg)";
                p.style.zIndex = 50 - currentPage;
                if(currentPage === 1) { book.classList.remove('is-open'); coverL.style.display = 'none'; }
                currentPage--;
                updateHint();
            }
        }

        function updateHint() {
            const h = document.getElementById('hint');
            if(!h) return;
            if(currentPage === 0) h.innerText = "Swipe Left to Open ‚û°Ô∏è";
            else if(currentPage === totalPages) h.innerText = "The End ‚ù§Ô∏è";
            else h.innerText = "Swipe to Flip";
        }
    </script>
</body>
</html>

